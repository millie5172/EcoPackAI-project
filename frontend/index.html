<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoPackAI - AI-Powered Sustainable Packaging</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --eco-green: #2d6a4f;
            --eco-light: #d8f3dc;
            --eco-accent: #52b788;
            --warning-orange: #f4a261;
        }

        body {
            background: linear-gradient(135deg, #f8f9fa 0%, var(--eco-light) 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            background: linear-gradient(90deg, var(--eco-green) 0%, #1b4332 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .hero-section {
            background: linear-gradient(135deg, var(--eco-green) 0%, #40916c 100%);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }

        .material-card {
            border-left: 4px solid var(--eco-green);
            margin-bottom: 1rem;
        }

        .score-badge {
            font-size: 1.2rem;
            font-weight: bold;
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }

        .score-excellent { background: var(--eco-green); color: white; }
        .score-good { background: var(--eco-accent); color: white; }
        .score-moderate { background: var(--warning-orange); color: white; }

        .progress {
            height: 10px;
            border-radius: 5px;
            background: #e9ecef;
        }

        .progress-bar {
            border-radius: 5px;
        }

        .recommendation-rank {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--eco-green);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--eco-green);
        }

        .dashboard-chart {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .nav-pills .nav-link.active {
            background-color: var(--eco-green);
        }

        .nav-pills .nav-link {
            color: var(--eco-green);
            font-weight: 500;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--eco-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--eco-green);
            margin-bottom: 1rem;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner-border {
            color: var(--eco-green);
            width: 3rem;
            height: 3rem;
        }

        .co2-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .co2-low { background: #d8f3dc; color: #1b4332; }
        .co2-medium { background: #fff3cd; color: #856404; }
        .co2-high { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#"><i class="bi bi-box-seam me-2"></i>EcoPackAI</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="#recommendation"><i class="bi bi-magic me-1"></i>AI Recommendation</a></li>
                    <li class="nav-item"><a class="nav-link" href="#dashboard"><i class="bi bi-graph-up me-1"></i>BI Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="#materials"><i class="bi bi-database me-1"></i>Material DB</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3">AI-Powered Sustainable Packaging</h1>
            <p class="lead">Optimize packaging decisions using Machine Learning & Business Intelligence</p>
            <div class="row mt-4 justify-content-center">
                <div class="col-md-3">
                    <div class="metric-value" id="totalCo2Saved">0</div>
                    <small>kg CO₂ Saved</small>
                </div>
                <div class="col-md-3">
                    <div class="metric-value" id="costReduction">0%</div>
                    <small>Avg Cost Reduction</small>
                </div>
                <div class="col-md-3">
                    <div class="metric-value" id="materialsAnalyzed">15</div>
                    <small>Eco Materials</small>
                </div>
            </div>
        </div>
    </div>

    <div class="container mb-5">
        <!-- Navigation Tabs -->
        <ul class="nav nav-pills mb-4 justify-content-center" id="mainTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="recommendation-tab" data-bs-toggle="pill" data-bs-target="#recommendation" type="button" role="tab">
                    <i class="bi bi-cpu me-2"></i>AI Recommendation Engine
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dashboard-tab" data-bs-toggle="pill" data-bs-target="#dashboard" type="button" role="tab">
                    <i class="bi bi-bar-chart-line me-2"></i>Sustainability Dashboard
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="materials-tab" data-bs-toggle="pill" data-bs-target="#materials" type="button" role="tab">
                    <i class="bi bi-layers me-2"></i>Material Database
                </button>
            </li>
        </ul>

        <div class="tab-content" id="mainTabContent">
            <!-- AI Recommendation Tab -->
            <div class="tab-pane fade show active" id="recommendation" role="tabpanel">
                <div class="row">
                    <!-- Input Form -->
                    <div class="col-lg-4">
                        <div class="card h-100">
                            <div class="card-header bg-white">
                                <h5 class="mb-0"><i class="bi bi-box me-2"></i>Product Parameters</h5>
                            </div>
                            <div class="card-body">
                                <form id="packagingForm">
                                    <div class="mb-3">
                                        <label class="form-label">Product Category</label>
                                        <select class="form-select" id="productCategory" required>
                                            <option value="">Select Category...</option>
                                            <option value="electronics">Electronics</option>
                                            <option value="food">Food & Beverage</option>
                                            <option value="cosmetics">Cosmetics</option>
                                            <option value="fragile">Fragile Items</option>
                                            <option value="clothing">Clothing</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Product Weight (kg)</label>
                                        <input type="number" class="form-control" id="productWeight" step="0.1" min="0.1" value="1.0" required>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Dimensions (L × W × H cm)</label>
                                        <div class="row">
                                            <div class="col-4"><input type="number" class="form-control" id="dimL" placeholder="L" value="20"></div>
                                            <div class="col-4"><input type="number" class="form-control" id="dimW" placeholder="W" value="15"></div>
                                            <div class="col-4"><input type="number" class="form-control" id="dimH" placeholder="H" value="10"></div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Fragility Level</label>
                                        <input type="range" class="form-range" id="fragility" min="1" max="10" value="5">
                                        <div class="d-flex justify-content-between small text-muted">
                                            <span>Durable</span>
                                            <span>Extremely Fragile</span>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Shipping Distance (km)</label>
                                        <input type="number" class="form-control" id="shippingDistance" value="1000" min="0">
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Priority</label>
                                        <select class="form-select" id="priority">
                                            <option value="balanced">Balanced (Cost + Eco)</option>
                                            <option value="eco">Maximum Sustainability</option>
                                            <option value="cost">Minimum Cost</option>
                                            <option value="protection">Maximum Protection</option>
                                        </select>
                                    </div>

                                    <button type="submit" class="btn btn-success w-100">
                                        <i class="bi bi-magic me-2"></i>Get AI Recommendation
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div class="col-lg-8">
                        <div class="loading-spinner" id="loadingSpinner">
                            <div class="spinner-border mb-3"></div>
                            <p class="text-muted">ML Models analyzing material suitability...<br>
                            <small>Running Random Forest Cost Prediction & XGBoost CO₂ Analysis</small></p>
                        </div>

                        <div id="recommendationResults" style="display: none;">
                            <div class="card mb-4 border-success">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h4 class="text-success mb-1">Top Recommendation</h4>
                                            <h2 class="fw-bold mb-0" id="topMaterialName">Sugarcane Bagasse</h2>
                                            <span class="badge bg-success mt-2" id="sustainabilityScore">98% Sustainable</span>
                                        </div>
                                        <div class="recommendation-rank">1</div>
                                    </div>

                                    <div class="row mt-4">
                                        <div class="col-md-3 text-center">
                                            <div class="text-muted small">CO₂ Footprint</div>
                                            <div class="fw-bold text-success" id="topCo2">0.12 kg</div>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <div class="text-muted small">Cost per Unit</div>
                                            <div class="fw-bold" id="topCost">$0.45</div>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <div class="text-muted small">Durability</div>
                                            <div class="fw-bold" id="topDurability">85/100</div>
                                        </div>
                                        <div class="col-md-3 text-center">
                                            <div class="text-muted small">Degradation</div>
                                            <div class="fw-bold text-success" id="topDegrade">60 days</div>
                                        </div>
                                    </div>

                                    <hr>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6><i class="bi bi-check-circle me-2"></i>Why This Material?</h6>
                                            <ul class="list-unstyled small" id="recommendationReasons">
                                                <li><i class="bi bi-arrow-right-short text-success"></i> Lowest CO₂ emissions for your product category</li>
                                                <li><i class="bi bi-arrow-right-short text-success"></i> Suitable for weight capacity of <span id="weightCapacity">5kg</span></li>
                                                <li><i class="bi bi-arrow-right-short text-success"></i> biodegrades within 60-90 days</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <h6><i class="bi bi-lightbulb me-2"></i>AI Insights</h6>
                                            <p class="small text-muted mb-0" id="aiInsight">
                                                Based on Random Forest regression analysis, this material offers optimal protection-to-weight ratio
                                                with 40% lower carbon footprint than conventional alternatives.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h5 class="mb-3">Alternative Recommendations</h5>
                            <div id="alternativeRecommendations">
                                <!-- Dynamically populated -->
                            </div>
                        </div>

                        <div class="card" id="emptyState">
                            <div class="card-body text-center py-5 text-muted">
                                <i class="bi bi-box-seam display-1 mb-3"></i>
                                <h5>Enter product details to get AI recommendations</h5>
                                <p class="mb-0">Our ML models (Random Forest & XGBoost) will analyze the optimal packaging material based on cost, CO₂ footprint, and durability.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BI Dashboard Tab -->
            <div class="tab-pane fade" id="dashboard" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <div class="feature-icon mx-auto"><i class="bi bi-cloud-check"></i></div>
                            <h4>2.4 tons</h4>
                            <p class="text-muted mb-0">CO₂ Reduction This Month</p>
                            <span class="badge bg-success mt-2">↑ 12% vs last month</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <div class="feature-icon mx-auto"><i class="bi bi-currency-dollar"></i></div>
                            <h4>$12,450</h4>
                            <p class="text-muted mb-0">Cost Savings YTD</p>
                            <span class="badge bg-success mt-2">↑ 8% vs target</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <div class="feature-icon mx-auto"><i class="bi bi-recycle"></i></div>
                            <h4>78%</h4>
                            <p class="text-muted mb-0">Recyclable Materials Used</p>
                            <span class="badge bg-info mt-2">On track</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center p-3">
                            <div class="feature-icon mx-auto"><i class="bi bi-leaf"></i></div>
                            <h4>92%</h4>
                            <p class="text-muted mb-0">Bio-based Adoption</p>
                            <span class="badge bg-warning text-dark mt-2">↑ 5%</span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-header bg-white">
                                <h5 class="mb-0">CO₂ Emissions by Material Type</h5>
                            </div>
                            <div class="card-body">
                                <div class="dashboard-chart">
                                    <canvas id="co2Chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-header bg-white">
                                <h5 class="mb-0">Cost Efficiency vs Sustainability</h5>
                            </div>
                            <div class="card-body">
                                <div class="dashboard-chart">
                                    <canvas id="scatterChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Monthly Sustainability Trends</h5>
                                <button class="btn btn-outline-success btn-sm" onclick="exportReport()">
                                    <i class="bi bi-download me-2"></i>Export Report
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="dashboard-chart">
                                    <canvas id="trendChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header bg-white">
                                <h5 class="mb-0">Material Usage Distribution</h5>
                            </div>
                            <div class="card-body">
                                <div class="dashboard-chart">
                                    <canvas id="pieChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Materials Database Tab -->
            <div class="tab-pane fade" id="materials" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4>Eco-Friendly Materials Database</h4>
                    <div class="input-group w-auto">
                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                        <input type="text" class="form-control" id="materialSearch" placeholder="Search materials...">
                    </div>
                </div>

                <div class="row" id="materialsGrid">
                    <!-- Materials will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Material Database based on research
        const materialsDB = [
            {
                id: 1,
                name: "Sugarcane Bagasse",
                type: "Plant Fiber",
                co2PerKg: 0.15,
                costPerUnit: 0.42,
                biodegradability: 98,
                durability: 85,
                recyclability: 100,
                decomposeTime: "45-90 days",
                decomposeDays: 67,
                certifications: ["EN 13432", "ASTM D6400"],
                applications: ["Food containers", "Plates", "Takeaway boxes"],
                color: "#2d6a4f",
                description: "Fibrous residue from sugarcane processing. Excellent for food packaging with high heat resistance."
            },
            {
                id: 2,
                name: "Mushroom Mycelium",
                type: "Bio-based",
                co2PerKg: 0.08,
                costPerUnit: 0.85,
                biodegradability: 100,
                durability: 90,
                recyclability: 100,
                decomposeTime: "30-45 days",
                decomposeDays: 37,
                certifications: ["Cradle to Cradle", "OK Compost"],
                applications: ["Protective packaging", "Electronics cushioning"],
                color: "#8b5a2b",
                description: "Grown from mushroom roots. Superior cushioning properties, replaces polystyrene foam."
            },
            {
                id: 3,
                name: "PLA (Polylactic Acid)",
                type: "Bioplastic",
                co2PerKg: 0.68,
                costPerUnit: 0.65,
                biodegradability: 85,
                durability: 75,
                recyclability: 60,
                decomposeTime: "90-180 days",
                decomposeDays: 135,
                certifications: ["EN 13432", "BPI Certified"],
                applications: ["Clear cups", "Cold food containers", "Films"],
                color: "#52b788",
                description: "Derived from corn starch. Industrial composting required. Clear appearance similar to PET."
            },
            {
                id: 4,
                name: "CPLA (Crystallized PLA)",
                type: "Bioplastic",
                co2PerKg: 0.75,
                costPerUnit: 0.78,
                biodegradability: 80,
                durability: 88,
                recyclability: 55,
                decomposeTime: "120-180 days",
                decomposeDays: 150,
                certifications: ["ASTM D6400"],
                applications: ["Hot drink cups", "Cutlery", "Hot food containers"],
                color: "#74c69d",
                description: "Heat-resistant PLA variant. Tolerates up to 90°C. Slower degradation due to crystallinity."
            },
            {
                id: 5,
                name: "Recycled Cardboard",
                type: "Recycled Paper",
                co2PerKg: 0.32,
                costPerUnit: 0.35,
                biodegradability: 95,
                durability: 70,
                recyclability: 95,
                decomposeTime: "60-90 days",
                decomposeDays: 75,
                certifications: ["FSC", "Recycled Content"],
                applications: ["Shipping boxes", "POS displays", "Paper bags"],
                color: "#d4a373",
                description: "Post-consumer recycled content. Well-established recycling infrastructure."
            },
            {
                id: 6,
                name: "Seaweed Packaging",
                type: "Marine Bio",
                co2PerKg: -0.05,
                costPerUnit: 1.20,
                biodegradability: 100,
                durability: 65,
                recyclability: 90,
                decomposeTime: "4-6 weeks",
                decomposeDays: 35,
                certifications: ["OK Compost HOME"],
                applications: ["Food wraps", "Sachets", "Edible packaging"],
                color: "#1b4332",
                description: "Carbon-negative material. Cultivation absorbs CO2. Marine biodegradable within weeks."
            },
            {
                id: 7,
                name: "Cornstarch Biopolymer",
                type: "Bio-based",
                co2PerKg: 0.45,
                costPerUnit: 0.58,
                biodegradability: 90,
               durability: 72,
                recyclability: 70,
                decomposeTime: "90-120 days",
                decomposeDays: 105,
                certifications: ["EN 13432"],
                applications: ["Flexible films", "Bags", "Loose fill"],
                color: "#f4a261",
                description: "Derived from maize. Good moisture resistance. Home compostable variants available."
            },
            {
                id: 8,
                name: "Bamboo Fiber",
                type: "Plant Fiber",
                co2PerKg: 0.22,
                costPerUnit: 0.55,
                biodegradability: 98,
                durability: 82,
                recyclability: 85,
                decomposeTime: "60-90 days",
                decomposeDays: 75,
                certifications: ["FSC", "Compostable"],
                applications: ["Rigid containers", "Cutlery", "Shipping materials"],
                color: "#8fbc8f",
                description: "Rapidly renewable resource. Natural antimicrobial properties. 3-5 year harvest cycle."
            }
        ];

        // Initialize Charts
        let co2Chart, scatterChart, trendChart, pieChart;

        function initCharts() {
            // CO2 Comparison Chart
            const ctx1 = document.getElementById('co2Chart').getContext('2d');
            co2Chart = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: materialsDB.map(m => m.name.split(' ')[0]),
                    datasets: [{
                        label: 'CO₂/kg (kg CO₂e)',
                        data: materialsDB.map(m => m.co2PerKg),
                        backgroundColor: materialsDB.map(m => m.co2PerKg < 0 ? '#1b4332' :
                            m.co2PerKg < 0.3 ? '#2d6a4f' :
                            m.co2PerKg < 0.6 ? '#52b788' : '#f4a261'),
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'kg CO₂e per kg material' }
                        }
                    }
                }
            });

            // Scatter Plot: Cost vs Sustainability
            const ctx2 = document.getElementById('scatterChart').getContext('2d');
            scatterChart = new Chart(ctx2, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Materials',
                        data: materialsDB.map(m => ({
                            x: m.costPerUnit,
                            y: (m.biodegradability + m.recyclability) / 2,
                            r: 10
                        })),
                        backgroundColor: materialsDB.map(m => m.color)
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'Cost per Unit ($)' },
                            beginAtZero: true
                        },
                        y: {
                            title: { display: true, text: 'Sustainability Score' },
                            min: 50,
                            max: 100
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (ctx) => materialsDB[ctx.dataIndex].name
                            }
                        }
                    }
                }
            });

            // Trend Chart
            const ctx3 = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctx3, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [
                        {
                            label: 'CO₂ Reduction (tons)',
                            data: [1.2, 1.5, 1.8, 2.1, 2.3, 2.4],
                            borderColor: '#2d6a4f',
                            backgroundColor: 'rgba(45, 106, 79, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Cost Savings ($1000s)',
                            data: [8, 9, 10, 11, 11.5, 12.4],
                            borderColor: '#f4a261',
                            backgroundColor: 'rgba(244, 162, 97, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });

            // Pie Chart
            const ctx4 = document.getElementById('pieChart').getContext('2d');
            pieChart = new Chart(ctx4, {
                type: 'doughnut',
                data: {
                    labels: ['Bagasse', 'Recycled Cardboard', 'PLA', 'Mushroom', 'Others'],
                    datasets: [{
                        data: [35, 28, 18, 12, 7],
                        backgroundColor: ['#2d6a4f', '#d4a373', '#52b788', '#8b5a2b', '#74c69d']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // AI Recommendation Logic
        function calculateMaterialScore(material, productData) {
            let score = 0;
            const weights = {
                co2: productData.priority === 'eco' ? 0.4 : 0.25,
                cost: productData.priority === 'cost' ? 0.4 : 0.25,
                durability: productData.priority === 'protection' ? 0.4 : 0.25,
                biodegradability: 0.25
            };

            // CO2 Score (lower is better, so invert)
            const maxCO2 = 1.0;
            score += (1 - (Math.max(0, material.co2PerKg) / maxCO2)) * weights.co2 * 100;

            // Cost Score (lower is better)
            const maxCost = 1.5;
            score += (1 - (material.costPerUnit / maxCost)) * weights.cost * 100;

            // Durability Score
            score += (material.durability / 100) * weights.durability * 100;

            // Biodegradability Score
            score += (material.biodegradability / 100) * weights.biodegradability * 100;

            // Category-specific adjustments
            if (productData.category === 'food' && material.decomposeDays < 100) score += 10;
            if (productData.fragility > 7 && material.durability > 80) score += 15;
            if (productData.weight > 5 && material.durability > 85) score += 10;

            return score;
        }

        function generateRecommendation(e) {
            e.preventDefault();

            // Show loading
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('recommendationResults').style.display = 'none';
            document.getElementById('emptyState').style.display = 'none';

            // Collect form data
            const productData = {
                category: document.getElementById('productCategory').value,
                weight: parseFloat(document.getElementById('productWeight').value),
                fragility: parseInt(document.getElementById('fragility').value),
                distance: parseInt(document.getElementById('shippingDistance').value),
                priority: document.getElementById('priority').value,
                dimensions: {
                    l: parseFloat(document.getElementById('dimL').value),
                    w: parseFloat(document.getElementById('dimW').value),
                    h: parseFloat(document.getElementById('dimH').value)
                }
            };

            // Simulate ML processing delay
            setTimeout(() => {
                // Calculate scores for all materials
                const scoredMaterials = materialsDB.map(m => ({
                    ...m,
                    totalScore: calculateMaterialScore(m, productData),
                    suitability: calculateSpecificSuitability(m, productData)
                }));

                // Sort by score
                scoredMaterials.sort((a, b) => b.totalScore - a.totalScore);

                // Display results
                displayRecommendations(scoredMaterials, productData);

                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('recommendationResults').style.display = 'block';
            }, 1500);
        }

        function calculateSpecificSuitability(material, product) {
            // ML Feature Engineering simulation
            const co2Impact = (1 - (Math.max(0, material.co2PerKg) / 1.0)) * 100;
            const costEfficiency = (1 - (material.costPerUnit / 1.5)) * 100;
            const protectionScore = material.durability * (1 - (product.fragility / 20));

            return {
                co2Impact: co2Impact.toFixed(1),
                costEfficiency: costEfficiency.toFixed(1),
                protectionScore: protectionScore.toFixed(1),
                overallSustainability: ((material.biodegradability + material.recyclability) / 2).toFixed(1)
            };
        }

        function displayRecommendations(materials, productData) {
            const top = materials[0];

            // Update top recommendation
            document.getElementById('topMaterialName').textContent = top.name;
            document.getElementById('sustainabilityScore').textContent = `${Math.round(top.totalScore)}% Match`;
            document.getElementById('topCo2').textContent = `${top.co2PerKg} kg`;
            document.getElementById('topCost').textContent = `$${top.costPerUnit.toFixed(2)}`;
            document.getElementById('topDurability').textContent = `${top.durability}/100`;
            document.getElementById('topDegrade').textContent = top.decomposeTime;
            document.getElementById('weightCapacity').textContent = `${Math.round(top.durability / 10)}kg`;

            // Update reasons
            const reasonsList = document.getElementById('recommendationReasons');
            reasonsList.innerHTML = `
                <li><i class="bi bi-arrow-right-short text-success"></i>
                    ${top.co2PerKg < 0.2 ? 'Carbon-negative or neutral material' : 'Low CO₂ emissions for product category'}
                </li>
                <li><i class="bi bi-arrow-right-short text-success"></i>
                    Suitable for ${productData.weight}kg weight capacity (rated to ${Math.round(top.durability/10)}kg)
                </li>
                <li><i class="bi bi-arrow-right-short text-success"></i>
                    ${top.decomposeTime} decomposition in standard composting
                </li>
                <li><i class="bi bi-arrow-right-short text-success"></i>
                    ${top.recyclability}% recyclable content
                </li>
            `;

            // Update AI insight
            const insights = [
                `XGBoost analysis predicts ${((1 - top.co2PerKg/0.8)*100).toFixed(0)}% lower carbon footprint vs conventional ${productData.category} packaging.`,
                `Random Forest model indicates optimal cost-efficiency ratio at $${top.costPerUnit}/unit for your volume.`,
                `Material Suitability Score: ${Math.round(top.totalScore)}/100 based on product fragility level ${productData.fragility}/10.`
            ];
            document.getElementById('aiInsight').textContent = insights[Math.floor(Math.random() * insights.length)];

            // Alternatives
            const altContainer = document.getElementById('alternativeRecommendations');
            altContainer.innerHTML = '';

            materials.slice(1, 4).forEach((mat, idx) => {
                const co2Class = mat.co2PerKg < 0.2 ? 'co2-low' : mat.co2PerKg < 0.5 ? 'co2-medium' : 'co2-high';
                const co2Icon = mat.co2PerKg < 0.2 ? 'bi-check-circle-fill' : 'bi-exclamation-circle-fill';

                const html = `
                    <div class="card material-card mb-2">
                        <div class="card-body py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="recommendation-rank" style="background: #6c757d; width: 35px; height: 35px; font-size: 1rem;">${idx + 2}</div>
                                    <div>
                                        <h6 class="mb-0 fw-bold">${mat.name}</h6>
                                        <small class="text-muted">${mat.type} • ${mat.decomposeTime}</small>
                                    </div>
                                </div>
                                <div class="text-end">
                                    <div class="fw-bold">$${mat.costPerUnit.toFixed(2)}</div>
                                    <span class="co2-indicator ${co2Class}">
                                        <i class="bi ${co2Icon}"></i> ${mat.co2PerKg} kg CO₂
                                    </span>
                                </div>
                            </div>
                            <div class="row mt-2 text-center small">
                                <div class="col-3 border-end">
                                    <div class="text-muted">Durability</div>
                                    <div class="fw-bold">${mat.durability}%</div>
                                </div>
                                <div class="col-3 border-end">
                                    <div class="text-muted">Bio</div>
                                    <div class="fw-bold">${mat.biodegradability}%</div>
                                </div>
                                <div class="col-3 border-end">
                                    <div class="text-muted">Match</div>
                                    <div class="fw-bold text-success">${Math.round(mat.totalScore)}%</div>
                                </div>
                                <div class="col-3">
                                    <div class="text-muted">Recycle</div>
                                    <div class="fw-bold">${mat.recyclability}%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                altContainer.innerHTML += html;
            });

            // Update dashboard metrics animation
            updateDashboardMetrics(top);
        }

        function updateDashboardMetrics(material) {
            // Simulate updating global metrics
            const co2Saved = Math.round(1000 / Math.max(0.1, material.co2PerKg));
            const costRed = Math.round((1 - material.costPerUnit/1.0) * 100);

            animateValue('totalCo2Saved', 0, co2Saved, 1000);
            animateValue('costReduction', 0, costRed, 1000);
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            const range = end - start;
            const minTimer = 50;
            let stepTime = Math.abs(Math.floor(duration / range));
            stepTime = Math.max(stepTime, minTimer);

            let startTime = new Date().getTime();
            let endTime = startTime + duration;
            let timer;

            function run() {
                let now = new Date().getTime();
                let remaining = Math.max((endTime - now) / duration, 0);
                let value = Math.round(end - (remaining * range));
                obj.innerHTML = value + (id === 'costReduction' ? '%' : '');
                if (value == end) {
                    clearInterval(timer);
                }
            }

            timer = setInterval(run, stepTime);
            run();
        }

        function renderMaterialsDB() {
            const grid = document.getElementById('materialsGrid');
            grid.innerHTML = '';

            materialsDB.forEach(mat => {
                const card = `
                    <div class="col-md-6 col-lg-4 mb-4 material-item" data-name="${mat.name.toLowerCase()}">
                        <div class="card h-100">
                            <div class="card-header bg-white border-0 pt-3">
                                <div class="d-flex justify-content-between align-items-start">
                                    <h6 class="fw-bold mb-0">${mat.name}</h6>
                                    <span class="badge" style="background: ${mat.color}">${mat.type}</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="small text-muted mb-3">${mat.description}</p>

                                <div class="mb-3">
                                    <div class="d-flex justify-content-between small mb-1">
                                        <span>Biodegradability</span>
                                        <span class="fw-bold">${mat.biodegradability}%</span>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar bg-success" style="width: ${mat.biodegradability}%"></div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <div class="d-flex justify-content-between small mb-1">
                                        <span>Durability</span>
                                        <span class="fw-bold">${mat.durability}/100</span>
                                    </div>
                                    <div class="progress">
                                        <div class="progress-bar" style="width: ${mat.durability}%; background: ${mat.color}"></div>
                                    </div>
                                </div>

                                <div class="row text-center small mt-3">
                                    <div class="col-4 border-end">
                                        <div class="text-muted">CO₂</div>
                                        <div class="fw-bold ${mat.co2PerKg < 0 ? 'text-success' : ''}">${mat.co2PerKg}</div>
                                        <div class="text-muted" style="font-size: 0.7rem">kg/kg</div>
                                    </div>
                                    <div class="col-4 border-end">
                                        <div class="text-muted">Cost</div>
                                        <div class="fw-bold">$${mat.costPerUnit}</div>
                                        <div class="text-muted" style="font-size: 0.7rem">per unit</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="text-muted">Degrades</div>
                                        <div class="fw-bold">${mat.decomposeDays}</div>
                                        <div class="text-muted" style="font-size: 0.7rem">days</div>
                                    </div>
                                </div>

                                <div class="mt-3">
                                    <small class="text-muted"><i class="bi bi-check-circle me-1"></i>${mat.certifications.join(', ')}</small>
                                </div>
                            </div>
                            <div class="card-footer bg-white border-0">
                                <small class="text-muted"><i class="bi bi-gear me-1"></i>Best for: ${mat.applications.join(', ')}</small>
                            </div>
                        </div>
                    </div>
                `;
                grid.innerHTML += card;
            });
        }

        function setupSearch() {
            document.getElementById('materialSearch').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('.material-item').forEach(item => {
                    const name = item.getAttribute('data-name');
                    item.style.display = name.includes(term) ? 'block' : 'none';
                });
            });
        }

        function exportReport() {
            alert('Sustainability Report exported!\n\nPDF generation would include:\n- CO2 reduction metrics\n- Cost analysis\n- Material usage trends\n- Compliance certificates');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('packagingForm').addEventListener('submit', generateRecommendation);
            initCharts();
            renderMaterialsDB();
            setupSearch();

            // Animate initial metrics
            animateValue('totalCo2Saved', 0, 2847, 1500);
            animateValue('costReduction', 0, 23, 1500);
        });
    </script>
</body>
</html>